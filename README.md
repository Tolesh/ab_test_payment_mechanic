# üí≥ –í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî A/B-—Ç–µ—Å—Ç –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã + SQL-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ + Python-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç (Karpov.Courses). –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π –æ–ø–ª–∞—Ç—ã: –æ—Ü–µ–Ω–∏–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, –¥–∞—ë–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞—Å–∫–∞—Ç–∫—É. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ—à–∞–µ–º SQL-–∑–∞–¥–∞—á–∏ (ARPU/ARPAU/CR) –∏ –ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ Python –¥–ª—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ –≤–ª–∏—è–Ω–∏–∏ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã (A/B-—Ç–µ—Å—Ç).
- –ü–æ—Å—á–∏—Ç–∞—Ç—å **ARPU, ARPAU, CR** –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º –≤ SQL.
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞ **Python**:
  - –ü–æ–¥—Ö–≤–∞—Ç –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ `groups_add.csv` —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
  - –ê–≤—Ç–æ–ø–µ—Ä–µ—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤.

## üßæ –î–∞–Ω–Ω—ã–µ
- `groups.csv` ‚Äî –≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (A ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å, B ‚Äî —Ç–µ—Å—Ç).
- `groups_add.csv` ‚Äî –¥–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—á–µ—Ä–µ–∑ 2 –¥–Ω—è).
- `active_studs.csv` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –¥–Ω–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.
- `checks.csv` ‚Äî –æ–ø–ª–∞—Ç—ã (—Å—É–º–º–∞/–¥–∞—Ç–∞).
- **SQL** (Redash ‚Üí —Å—Ö–µ–º–∞ `StartDA`): —Ç–∞–±–ª–∏—Ü—ã `peas`, `studs`, `final_project_check`.

## üõ†Ô∏è –°—Ç–µ–∫
**Python**: pandas, numpy, scipy, matplotlib, seaborn  
**SQL**: PostgreSQL (Redash / StartDA)

## üî¨ –ß–∞—Å—Ç—å 1 ‚Äî A/B-—Ç–µ—Å—Ç (Python)
**–ú–µ—Ç—Ä–∏–∫–∏**:
- **CR –≤ –æ–ø–ª–∞—Ç—É**, **ARPU**, **ARPPU**, **Average check**, **Revenue uplift**.
- –ü–æ –∞–∫—Ç–∏–≤–Ω—ã–º: CR –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º, ARPAU.

**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è**:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –≥—Ä—É–ø–ø, –æ–∫–Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, outliers.
- –°—Ç–∞—Ç–ø—Ä–æ–≤–µ—Ä–∫–∏: `t-test` (–ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏/–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –æ–±—ä—ë–º–∞—Ö), –ú–∞–Ω–Ω-–£–∏—Ç–Ω–∏/–±—É—Ç—Å—Ç—Ä–∞–ø –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö.
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –¥–æ–∑–∞–≥—Ä—É–∑–∫—É `groups_add.csv`: —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Å—Ç–æ–ª–±—Ü—ã, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç.

**–í—ã–≤–æ–¥**:
- p-value, –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∏ **—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: —Ä–∞—Å–∫–∞—Ç—ã–≤–∞—Ç—å/–Ω–µ —Ä–∞—Å–∫–∞—Ç—ã–≤–∞—Ç—å/—Ä–∞—Å–∫–∞—Ç—ã–≤–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç–Ω–æ.

## üóÑÔ∏è –ß–∞—Å—Ç—å 2 ‚Äî SQL-–∑–∞–¥–∞—á–∏

### 2.1 –û—á–µ–Ω—å —É—Å–µ—Ä–¥–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏
**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü **‚â• 20** –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö ¬´–≥–æ—Ä–æ—à–∏–Ω¬ª.  
**–¢–∞–±–ª–∏—Ü–∞:** `peas(st_id, timest, correct, subject)`

–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ `st_id` –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü.
- –§–∏–ª—å—Ç—Ä `correct = true`.
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∏–Ω–¥–µ–∫—Å—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏/—Ñ–∏–ª—å—Ç—Ä–∞–º, –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü—É.

### 2.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–æ—Ä–æ–Ω–∫–∏ –æ–ø–ª–∞—Ç—ã
**–¢–∞–±–ª–∏—Ü—ã:**  
- `peas` ‚Äî —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å),  
- `studs(st_id, test_grp)` ‚Äî –≥—Ä—É–ø–ø–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞,  
- `final_project_check(st_id, sale_time, money, subject)` ‚Äî –ø–æ–∫—É–ø–∫–∏.

**–ù—É–∂–Ω–æ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–ª—è –≥—Ä—É–ø–ø**:  
- **ARPU**, **ARPAU**, **CR –≤ –ø–æ–∫—É–ø–∫—É**,  
- **CR –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–∫—É–ø–∫—É**,  
- **CR –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ ‚Üí –ø–æ–∫—É–ø–∫–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏** (`subject = 'math'`).

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π**:
- –ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: **> 10** –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è.
- –ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ: **‚â• 2** –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ `math`.

## üß© –ß–∞—Å—Ç—å 3 ‚Äî Python-—Ñ—É–Ω–∫—Ü–∏–∏
- `load_and_merge_groups(groups.csv, groups_add.csv)` ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–æ–∑–∞–≥—Ä—É–∑–∫—É (—Ä–∞–∑–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏), –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç.
- `recalc_metrics(df)` ‚Äî –ø–µ—Ä–µ—Å—á—ë—Ç CR/ARPU/ARPPU/ARPAU —Å —É—á—ë—Ç–æ–º –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- `plot_metrics(df)` ‚Äî –ª–∏–Ω–∏–∏/–±–∞—Ä-—á–∞—Ä—Ç—ã —Å –ø–æ–¥–ø–∏—Å—è–º–∏ (matplotlib).

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã A/B-—Ç–µ—Å—Ç–∞

**–¶–µ–ª—å:** –æ—Ü–µ–Ω–∏—Ç—å, –≤–ª–∏—è–µ—Ç –ª–∏ –Ω–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –æ–ø–ª–∞—Ç—ã –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å—Ç–æ–∏—Ç –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ—ë –Ω–∞ –≤—Å–µ—Ö.

### üìä –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
| –ú–µ—Ç—Ä–∏–∫–∞              | –ì—Ä—É–ø–ø–∞ A (–∫–æ–Ω—Ç—Ä–æ–ª—å) | –ì—Ä—É–ø–ø–∞ B (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç) |
|----------------------|---------------------|-------------------------|
| –ö–æ–ª-–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 14 693              | 59 883                  |
| –ö–æ–Ω–≤–µ—Ä—Å–∏—è (CR)       | 0.728 %             | 0.724 %                 |
| ARPU                 | 6.27 ‚ÇΩ              | 8.04 ‚ÇΩ                  |
| ARPPU                | 860.71 ‚ÇΩ            | 1 108.82 ‚ÇΩ              |

### üß™ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
- **CR (–∫–æ–Ω–≤–µ—Ä—Å–∏—è)**: Z-test, p-value = 0.9644 ‚Üí **–Ω–µ—Ç –∑–Ω–∞—á–∏–º—ã—Ö –æ—Ç–ª–∏—á–∏–π**  
- **ARPU**: Welch‚Äôs t-test, p-value = 0.0632, CI95% = [‚àí3.63; 0.1] ‚Üí **–ø–æ—á—Ç–∏ –∑–Ω–∞—á–∏–º–æ**  
- **ARPPU**: Welch‚Äôs t-test, p-value = 0.0047, CI95% = [‚àí419.09; ‚àí77.14] ‚Üí **–∑–Ω–∞—á–∏–º–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ**

### üìå –í—ã–≤–æ–¥
- CR –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí –Ω–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ **–Ω–µ –≤–ª–∏—è–µ—Ç** –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –ø–æ–∫—É–ø–æ–∫.  
- ARPU –≤—ã—Ä–æ—Å–ª–∞, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏–º–æ (p ‚âà 0.06).  
- ARPPU –≤—ã—Ä–æ—Å–ª–∞ –∑–Ω–∞—á–∏–º–æ: –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç—Ä–∞—Ç—è—Ç –Ω–∞ **77‚Äì419 ‚ÇΩ –±–æ–ª—å—à–µ**.  
- **–ó–Ω–∞—á–∏–º—ã—Ö –º–∏–Ω—É—Å–æ–≤ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ.**

üëâ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø—Ä–∞–≤–¥–∞–Ω, –µ—Å–ª–∏ —Ü–µ–ª—å ‚Äî —É–≤–µ–ª–∏—á–∏—Ç—å –≤—ã—Ä—É—á–∫—É –æ—Ç –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## üñºÔ∏è –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ ARPU –ø–æ –≥—Ä—É–ø–ø–∞–º  
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ ARPPU –ø–æ –≥—Ä—É–ø–ø–∞–º  
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ CR –ø–æ –≥—Ä—É–ø–ø–∞–º  

![ARPU by Group](images/arpu_by_group.jpeg)  
![ARPPU by Group](images/arppu_by_group.jpeg)  
![CR by Group](images/cr_by_group.jpeg)

## ‚ñ∂Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
- Python 3.10+
- `pip install -r requirements.txt`
- –û—Ç–∫—Ä—ã—Ç—å `notebooks/ab_test_sql_python.ipynb`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
project_2_ab_sql_python/
‚îú‚îÄ README.md
‚îú‚îÄ notebooks/
‚îÇ ‚îî‚îÄ ab_test_sql_python.ipynb
‚îú‚îÄ data/ # csv (–µ—Å–ª–∏ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å)
‚îî‚îÄ sql/
‚îú‚îÄ diligent_students.sql
‚îî‚îÄ funnel_metrics.sql

---

### ‚ÑπÔ∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä
–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ [Karpov.Courses](https://karpov.courses).  
–°–æ–±–ª—é–¥–µ–Ω—ã —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤; –¥–æ—Å—Ç—É–ø—ã –∏ –∑–∞–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è.